// Generated by BUCKLESCRIPT VERSION 4.0.7, PLEASE EDIT WITH CARE

import * as $$Map from "../node_modules/bs-platform/lib/es6/map.js";
import * as $$Set from "../node_modules/bs-platform/lib/es6/set.js";
import * as Char from "../node_modules/bs-platform/lib/es6/char.js";
import * as Curry from "../node_modules/bs-platform/lib/es6/curry.js";
import * as Int32 from "../node_modules/bs-platform/lib/es6/int32.js";
import * as Caml_builtin_exceptions from "../node_modules/bs-platform/lib/es6/caml_builtin_exceptions.js";

var StateSet = $$Set.Make([Int32.compare]);

var CharMap = $$Map.Make([Char.compare]);

function find_states(sym, nfa, m) {
  try {
    return Curry._2(CharMap[/* find */21], sym, Curry._1(nfa[/* next */2], m));
  }
  catch (exn){
    if (exn === Caml_builtin_exceptions.not_found) {
      return StateSet[/* empty */0];
    } else {
      throw exn;
    }
  }
}

function nextss(curs, sym, nfa) {
  var f = function (param) {
    return find_states(sym, nfa, param);
  };
  var ss = curs;
  return Curry._3(StateSet[/* fold */13], (function (s) {
                return Curry._1(StateSet[/* union */6], Curry._1(f, s));
              }), ss, StateSet[/* empty */0]);
}

function accept(nfa, inp) {
  var _cur = Curry._1(StateSet[/* singleton */4], nfa[/* start */0]);
  var _param = inp;
  while(true) {
    var param = _param;
    var cur = _cur;
    if (param) {
      _param = param[1];
      _cur = nextss(cur, param[0], nfa);
      continue ;
    } else {
      return !Curry._1(StateSet[/* is_empty */1], Curry._2(StateSet[/* inter */7], cur, nfa[/* finals */1]));
    }
  };
}

export {
  StateSet ,
  CharMap ,
  accept ,
  
}
/* StateSet Not a pure module */
